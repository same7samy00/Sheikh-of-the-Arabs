<!DOCTYPE html>
<html lang="ar" dir="rtl"><head><title>لوحة التحكم</title><link rel="stylesheet" href="style.css"><link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet"></head>
<body>
    <aside class="sidebar"><div class="logo">شيخ <span>العرب</span></div><ul class="nav-list"><li class="nav-item"><a href="dashboard.html" class="nav-link"><i class="ri-dashboard-line"></i><span>التحكم</span></a></li><li class="nav-item"><a href="inventory.html" class="nav-link"><i class="ri-box-3-line"></i><span>المخزون</span></a></li><li class="nav-item"><a href="pos.html" class="nav-link"><i class="ri-shopping-cart-line"></i><span>نقطة البيع</span></a></li><li class="nav-item logout"><a href="#" id="logoutButton" class="nav-link"><i class="ri-logout-box-line"></i><span>الخروج</span></a></li></ul></aside>
    <main class="main-content">
        <div class="page-header"><h1 class="page-title">لوحة التحكم</h1></div>
        <div class="kpi-grid">
            <div class="card kpi-card"><div class="details"><div class="title">إجمالي المنتجات</div><div class="value" id="totalProducts">...</div></div></div>
            <div class="card kpi-card"><div class="details"><div class="title">منتجات قليلة المخزون</div><div class="value" id="lowStockProducts">...</div></div></div>
            <div class="card kpi-card"><div class="details"><div class="title">قيمة المخزون (جنيه)</div><div class="value" id="totalInventoryValue">...</div></div></div>
        </div>
    </main>
    <div id="notification-container"></div><script src="shared.js" type="module"></script>
    <script type="module">
        import { db } from './shared.js';
        import { collection, getDocs } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";
        const totalProductsEl = document.getElementById('totalProducts'), lowStockProductsEl = document.getElementById('lowStockProducts'), totalInventoryValueEl = document.getElementById('totalInventoryValue');
        async function fetchData(){ try { const snapshot = await getDocs(collection(db, "products")); let total=0, low=0, value=0; snapshot.forEach(doc => { const p = doc.data(); total++; if (p.quantity <= 10 && p.quantity > 0) low++; value += (p.quantity||0)*(p.pricePerUnit||0); }); totalProductsEl.textContent = total; lowStockProductsEl.textContent = low; totalInventoryValueEl.textContent = value.toFixed(2); } catch (e) { console.error(e); } }
        fetchData();
    </script>
</body></html>
